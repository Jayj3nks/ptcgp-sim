
# Paste the following into ptcgp_sim/ptcgp_sim/cli.py (near other @app.command()s)

@app.command()
def validate_deck(deck_file: str, energy_types: str):
    from .deckio import normalize_deck_dict, validate_deck as vdeck
    import json
    src = json.load(open(deck_file, "r"))
    cards, warns = normalize_deck_dict(src.get("cards", {}))
    ok, msgs = vdeck(cards, [e.strip() for e in energy_types.split(",") if e.strip()])
    print(json.dumps({
        "normalized_cards": cards,
        "warnings": warns,
        "valid": ok,
        "messages": msgs
    }, indent=2))

@app.command()
def normalize_deck(in_file: str, out_file: str):
    from .deckio import normalize_deck_dict
    import json
    src = json.load(open(in_file, "r"))
    cards, warns = normalize_deck_dict(src.get("cards", {}))
    dst = {"cards": cards, "energy_types": src.get("energy_types", [])}
    json.dump(dst, open(out_file, "w"), indent=2)
    print(json.dumps({"warnings": warns, "out": out_file}, indent=2))

@app.command()
def run_meta(meta_file: str, games: int = 200, seed: int = 42):
    from .meta_runner import run_meta
    import json
    res = run_meta(meta_file, games=games, seed=seed)
    print(json.dumps(res, indent=2))
